"use strict";const n=require("path"),{app:o,BrowserWindow:r}=require("electron"),{creatProtocol:a}=require("./module/protocol"),i=require("electron-is-dev"),{createTray:l,createTrayWindow:s}=require("./module/tray"),{setThumbarButton:c}=require("./module/thumbarButtons");a();i||(global.__img=n.join(__dirname,"./img"),global.__images=n.join(__dirname,"./images"));const w=i?"public/images/tray.ico":`${global.__images}/tray.ico`;process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";function t(){global.win=new r({center:!0,show:!1,minWidth:1500,minHeight:670,resizable:!0,alwaysOnTop:!1,icon:w,titleBarStyle:"hiddenInset",frame:process.platform!=="win32",backgroundColor:"#fff",hasShadow:!0,webPreferences:{devTools:i,webSecurity:!0,nodeIntegration:!0,contextIsolation:!0,preload:n.join(__dirname,"./preload.js")}}),global.win.once("ready-to-show",()=>{global.win.show(),process.platform==="win32"&&(c(!1),global.tray=l(),global.trayWindow=s())}),process.platform,i?(global.win.loadURL("http://localhost:3100/jingluo"),global.win.webContents.openDevTools()):global.win.loadFile(n.join(__dirname,"../index.html")),global.win.on("close",e=>{if(e.preventDefault(),process.platform!=="darwin")return global.win.hide()}),global.win.on("closed",e=>{})}o.whenReady().then(()=>{t()});o.on("second-instance",()=>{const e=BrowserWindowsMap.get(global.win.id);e&&(e.restore(),e.show())});o.on("activate",()=>{if(!r.getAllWindows().length)return t()});o.on("window-all-closed",()=>{if(process.platform!=="darwin")return o.quit()});
