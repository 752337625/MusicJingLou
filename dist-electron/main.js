"use strict";const{app:e,BrowserWindow:n,protocol:r}=require("electron"),o=require("electron-is-dev"),{createTray:a}=require("./module/tray"),{setThumbarButtons:t}=require("./module/userTasks"),i=require("path");o||(global.__img=i.join(__dirname,"./img"),global.__images=i.join(__dirname,"./images"));const s=o?"public/images/tray.ico":`${global.__images}/tray.ico`;r.registerSchemesAsPrivileged([{scheme:"jingluo",privileges:{secure:!0,standard:!0}}]);process.env.ELECTRON_DISABLE_SECURITY_WARNINGS="true";function l(){global.win=new n({width:1100,height:660,center:!0,show:!1,minHeight:660,minWidth:1100,resizable:!0,focusable:!0,alwaysOnTop:!1,icon:s,frame:!1,backgroundColor:"#fff",hasShadow:!0,webPreferences:{devTools:o,webSecurity:!0,nodeIntegration:!0,contextIsolation:!0,preload:i.join(__dirname,"./preload.js")}}),global.win.once("ready-to-show",()=>{global.win.show(),process.platform==="win32"&&t(global.win,!1)}),process.platform==="win32"&&(global.win.removeMenu(),global.tray=a(),console.log(global.tray.getBounds())),o?(global.win.loadURL("http://localhost:3100/jingluo"),global.win.webContents.openDevTools()):global.win.loadFile(i.join(__dirname,"../index.html")),global.win.on("close",c=>{})}e.whenReady().then(()=>{l(),e.on("activate",()=>{n.getAllWindows().length===0&&l()})});e.on("window-all-closed",()=>{process.platform!=="darwin"&&e.quit()});
