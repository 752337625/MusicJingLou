"use strict";const{app:e,BrowserWindow:n,protocol:a}=require("electron"),o=require("electron-is-dev"),{createTray:r}=require("./module/tray"),{setThumbarButtons:t}=require("./module/userTasks"),i=require("path");o||(global.__img=i.join(__dirname,"./img"),global.__images=i.join(__dirname,"./images"));const s=o?"public/images/tray.ico":`${global.__images}/tray.ico`;a.registerSchemesAsPrivileged([{scheme:"jingluo",privileges:{secure:!0,standard:!0}}]);function l(){global.win=new n({width:1200,height:900,center:!0,show:!1,minHeight:900,minWidth:1200,resizable:!0,focusable:!0,alwaysOnTop:!1,icon:s,frame:!1,backgroundColor:"#fff",hasShadow:!0,webPreferences:{devTools:o,webSecurity:!0,nodeIntegration:!0,contextIsolation:!1,preload:i.join(__dirname,"./preload.js")}}),global.win.once("ready-to-show",()=>{global.win.show(),global.win.focus(),process.platform==="win32"&&t(global.win,!1)}),process.platform==="win32"&&(global.win.removeMenu(),global.tray=r()),o?(global.win.loadURL("http://localhost:3100/jingluo"),global.win.webContents.openDevTools()):global.win.loadFile(i.join(__dirname,"../index.html")),global.win.on("close",c=>{})}e.whenReady().then(()=>{l(),e.on("activate",()=>{n.getAllWindows().length===0&&l()})});e.on("window-all-closed",()=>{process.platform!=="darwin"&&e.quit()});
